id: http-trace-enabled

info:
  name: HTTP TRACE method is enabled
  author: pdteam
  severity: info
  reference: https://portswigger.net/kb/issues/00500a00_http-trace-method-is-enabled
  description: |
    The HTTP TRACE method is designed for diagnostic purposes. If enabled, the web server will respond to requests that use the TRACE method by echoing in its response the exact request that was received.
    This behavior is often harmless, but occasionally leads to the disclosure of sensitive information such as internal authentication headers appended by reverse proxies. This functionality could historically be used to bypass the HttpOnly cookie flag on cookies, but this is no longer possible in modern web browsers.

requests:
  - raw:
      - |
        TRACE / HTTP/1.1
        Host: {{Hostname}}
        Connection: close
        Cookie: dGVzdA==

    matchers-condition: and
    matchers:

      - type: word
        words:
          - "TRACE / HTTP/1.1"
          - "Cookie: dGVzdA=="

      - type: status
        status:
          - 200
