id: QNAP-QTS

info:
  name: Searches for the vulnerabilty QNAP QTS and Photo Station 6.0.3
  author: pikpikcu
  severity: info
  description: Searches for the vulnerabilty QNAP QTS and Photo Station 6.0.3

  # Vendor Homepage: https://www.qnap.com
  # Version: QTS < 4.4.1 |  Photo Station < 6.0.3
  # CVE: CVE-2019-7192, CVE-2019-7193, CVE-2019-7194, CVE-2019-7195
  # References: https://www.qnap.com/zh-tw/security-advisory/nas-201911-25
  # References: https://medium.com/@cycraft_corp/qnap-pre-auth-root-rce-affecting-312k-devices-on-the-internet-fc8af285622e
  # Exploit: https://github.com/th3gundy/CVE-2019-7192_QNAP_Exploit
  # Demo: http://123.241.139.119:8080
  # Shodan Dork: Content-Length:580 "http server 1.0"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/photo/p/api/video.php"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '[ 401 Unauthorized ]'
